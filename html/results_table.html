<tr ng-if="testDrive == true" ng-repeat="(index,result) in value" name="{{result.university}}">
    <td valign="top" style="max-height:400px;overflow:hidden">
        <div class="result-header">
            <table class="match-parent">
                <tr>
                    <td align="center" valign="middle" name="opener" onclick="toggle($(this).find('span'))">
                        <span class="glyphicon glyphicon-chevron-right" name="closed" data="yes" resource-id="{{result.id}}"
                        resource-type="{{key}}" style="margin-right:0.5em;cursor:pointer"></span>
                    </td>
                    <td align="left" valign="middle" style="width:75%" onclick="toggle(this)" class="result-name"
                    ng-if="testDrive == false">
                        <a href="single_display.php?id={{result.id}}&type=Advisor" ng-show="'{{key}}' == 'advisors'"
                        target="_blank">
                            <h4 title="{{result.name}}" class="ng-binding">
		{{result.name}}
	      </h4>
                        </a>
                        <a href="single_display.php?id={{result.id}}&type=Course" ng-show="'{{key}}' == 'courses'"
                        target="_blank">
                            <h4 title="{{result.name}}" class="ng-binding">
		{{result.name}}
	      </h4>
                        </a>
                        <a href="single_display.php?id={{result.id}}&type=Thesis" ng-show="'{{key}}' == 'theses'"
                        target="_blank">
                            <h4 title="{{result.name}}" class="ng-binding">
		{{result.name}}
	      </h4>
                        <a href="single_display.php?id={{result.id}}&type=Extracurricular" ng-show="'{{key}}' == 'extracurriculars'"
                            target="_blank">
                                <h4 title="{{result.name}}" class="ng-binding">
		{{result.name}}
	      </h4>
                            </a>
                            <a href="single_display.php?id={{result.id}}&type=Grant" ng-show="'{{key}}' == 'grants'"
                            target="_blank">
                                <h4 title="{{result.name}}" class="ng-binding">
		{{result.name}}
	      </h4>
                            </a>
                            <h6><span ng-if="alphaExists(result.description)">{{snippet(result.description)}},</span> {{result.department}}</h6>
                    </td>
                    <!-- RESTRICT USE IF NOT SIGNED UP -->
                    <td align="left" valign="middle" style="width:75%" onclick="toggle(this)" class="result-name"
                    ng-if="testDrive == true">
                        <a href="javascript:void(0)" onclick="showForm('reg_form')" ng-show="'{{key}}' == 'advisors'"
                        target="_blank">
                            <h4 title="{{result.name}}" class="ng-binding">
		{{result.name}}
	      </h4>
                        </a>
                    </td>

                    <td align="right" valign="middle" style="width:20%;padding-right:2%;" onclick="toggle(this)">
                        <table>
                            <tr>
                                <td>
                                    <span class="glyphicon glyphicon-star pl-hover" ng-class="{'starred':isSavedResource(result.id,result.type)}"
                                    title="Save this result" ng-click="toggleFavorite(result.id,result.type)"></span>
                                </td>
                                <td ng-if="result.email">
                                    <a href="mailto:{{getEmail(result.email)}}" ng-if="key == 'advisors' && result.email != '{}' && result.email != ''">
                                        <span class="glyphicon glyphicon-envelope pl-hover" title="Contact this advisor"></span>
                                    </a>
                                    <span class="glyphicon glyphicon-envelope" style="margin-left:0.75em;color:#fff"
                                    ng-if="key != 'advisors' || !alphaExists(result.email)"></span>
                                </td>
                                <td>
                                    <a href="single_display.php?id={{result.id}}&type=Advisor" ng-show="'{{key}}' == 'advisors'"
                                    target="_blank">
                                        <span class="glyphicon glyphicon-new-window pl-hover" title="View details"></span>
                                    </a>
                                    <a href="single_display.php?id={{result.id}}&type=Course" ng-show="'{{key}}' == 'courses'"
                                    target="_blank">
                                        <span class="glyphicon glyphicon-new-window pl-hover" title="View details"></span>
                                    </a>
                                    <a href="single_display.php?id={{result.id}}&type=Thesis" ng-show="'{{key}}' == 'theses'"
                                    target="_blank">
                                        <span class="glyphicon glyphicon-new-window pl-hover" title="View details"></span>
                                    </a>
                                    <a href="single_display.php?id={{result.id}}&type=Extracurricular" ng-show="'{{key}}' == 'extracurriculars'"
                                    target="_blank">
                                        <span class="glyphicon glyphicon-new-window pl-hover" title="View details"></span>
                                    </a>
                                </td>
                                <td>
                                    <a href="single_display.php?id={{result.id}}&type={{result.type}}" ng-show="'{{key}}' == 'grants'"
                                    target="_blank">
                                        <span class="glyphicon glyphicon-new-window pl-hover" title="View details"></span>
                                    </a>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </div>
        <div class="hide result-body">
            <table class="match-parent">
                <tr>
                    <td valign="top">
                        <img src="{{result.picture.replace('.png','Red.png')}}" width="50" />
                    </td>
                    <td name="description_box">
                        <div ng-if="common.alphaExists(result.block)==true" data-ng-bind-html="displayHTML(result.block)"></div>
                        <div ng-if="common.alphaExists(result.block)==false" data-ng-bind-html="displayHTML(result.description)"></div>
                        <br/>
                        <a href="single_display.php?id={{result.id}}&type=Advisor" ng-show="'{{key}}' == 'advisors'"
                        target="_blank">
	      See Details
	    </a>
                        <a href="single_display.php?id={{result.id}}&type=Course" ng-show="'{{key}}' == 'courses'"
                        target="_blank">
	      See Details
	    </a>
                        <a href="single_display.php?id={{result.id}}&type=Thesis" ng-show="'{{key}}' == 'theses'"
                        target="_blank">
	      See Details
	    </a>
                        <a href="single_display.php?id={{result.id}}&type={{result.type}}" ng-show="'{{key}}' == 'grants'"
                        target="_blank">
	      See Details
	    </a>
                        <a href="single_display.php?id={{result.id}}&type={{result.type}}" ng-show="'{{key}}' == 'extracurriculars'"
                        target="_blank">
	      See Details
	    </a>
                    </td>
                </tr>
            </table>
        </div>
    </td>
</tr>

<tr ng-if="testDrive == false" ng-repeat="(index,result) in value" name="{{result.department.replaceAll(' ','_')}}">
    <td valign="top" style="max-height:400px;overflow:hidden">
        <div class="result-header">
            <table class="match-parent">
                <tr>
                    <td align="center" valign="middle" name="opener" onclick="toggle($(this).find('span'))">
                        <span class="glyphicon glyphicon-chevron-right" name="closed" data="yes" resource-id="{{result.id}}"
                        resource-type="{{key}}" style="margin-right:0.5em;cursor:pointer"></span>
                    </td>
                    <td align="left" valign="middle" style="width:75%" onclick="toggle(this)" class="result-name">
                        <a href="single_display.php?id={{result.id}}&type=Advisor" ng-show="'{{key}}' == 'advisors'"
                        target="_blank">
                            <h4 title="{{result.name}}" class="ng-binding">
		{{result.name}}
	      </h4>
                        </a>
                        <a href="single_display.php?id={{result.id}}&type=Course" ng-show="'{{key}}' == 'courses'"
                        target="_blank">
                            <h4 title="{{result.name}}" class="ng-binding">
		{{result.name}}
	      </h4>
                        </a>
                        <a href="single_display.php?id={{result.id}}&type=Thesis" ng-show="'{{key}}' == 'theses'"
                        target="_blank">
                            <h4 title="{{result.name}}" class="ng-binding">
		{{result.name}}
	      </h4>
                        </a>
                        <a href="single_display.php?id={{result.id}}&type={{result.type}}" ng-show="'{{key}}' == 'grants'"
                        target="_blank">
                            <h4 title="{{result.name}}" class="ng-binding">
		{{result.name}}
	      </h4>
                        </a>
                        <a href="single_display.php?id={{result.id}}&type={{result.type}}" ng-show="'{{key}}' == 'extracurriculars'"
                        target="_blank">
                            <h4 title="{{result.name}}" class="ng-binding">
		{{result.name}}
	      </h4>
                        </a>
                        <h6><span ng-if="alphaExists(result.description)">{{common.stripTags(snippet(result.description))}},</span> {{result.department}}</h6>
                    </td>
                    <td align="right" valign="middle" style="width:20%;padding-right:2%;" onclick="toggle(this)">
                        <table>
                            <tr>
                                <td>
                                    <span ng-if="testDrive == false" class="glyphicon glyphicon-star pl-hover" ng-class="{'starred':isSavedResource(result.id,result.type)}"
                                    title="Save this result" ng-click="toggleFavorite(result.id,result.type)"></span>

                                    <!-- RESTRICT USE IF NOT SIGNED UP -->
                                    <span ng-if="testDrive == true" class="glyphicon glyphicon-star pl-hover" ng-class="{'starred':isSavedResource(result.id,result.type)}"
                                    title="Save this result" ng-click="toggleFavorite(result.id,result.type)"></span>
                                </td>
                                <td ng-if="result.email">
                                    <a href="mailto:{{getEmail(result.email)}}" ng-if="key == 'advisors' && result.email != '{}' && result.email != '' && testDrive == false">
                                        <span class="glyphicon glyphicon-envelope pl-hover" title="Contact this advisor"></span>
                                    </a>
                                    <!-- RESTRICT USE IF NOT SIGNED UP -->
                                    <a href="javascript:void(0)" ng-if="testDrive == true" onclick="showForm('reg_form')">
                                        <span class="glyphicon glyphicon-envelope pl-hover" title="Contact this advisor"></span>
                                    </a>

                                    <!-- This takes up space so that everything is in nice columns -->
                                    <span class="glyphicon glyphicon-envelope" style="margin-left:0.75em;color:#fff"
                                    ng-if="key != 'advisors' || !alphaExists(result.email)"></span>
                                </td>
                                <td ng-if="testDrive == false">
                                    <a href="single_display.php?id={{result.id}}&type=Advisor" ng-show="'{{key}}' == 'advisors'"
                                    target="_blank">
                                        <span class="glyphicon glyphicon-new-window pl-hover" title="View details"></span>
                                    </a>
                                    <a href="single_display.php?id={{result.id}}&type=Course" ng-show="'{{key}}' == 'courses'"
                                    target="_blank">
                                        <span class="glyphicon glyphicon-new-window pl-hover" title="View details"></span>
                                    </a>
                                    <a href="single_display.php?id={{result.id}}&type=Thesis" ng-show="'{{key}}' == 'theses'"
                                    target="_blank">
                                        <span class="glyphicon glyphicon-new-window pl-hover" title="View details"></span>
                                    </a>
                                    <a href="single_display.php?id={{result.id}}&type={{result.type}}" ng-show="'{{key}}' == 'grants'"
                                    target="_blank">
                                        <span class="glyphicon glyphicon-new-window pl-hover" title="View details"></span>
                                    </a>
                                </td>
                                <!-- RESTRICT USE IF NOT SIGNED UP -->
                                <td ng-if="testDrive == true">
                                    <a href="javascript:void(0)" onclick="showForm('reg_form')" ng-show="'{{key}}' == 'extracurriculars'"
                                    target="_blank">
                                        <span class="glyphicon glyphicon-new-window pl-hover" title="View details"></span>
                                    </a>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </div>
        <div class="hide result-body">
            <table class="match-parent">
                <tr>
                    <td valign="top">
                        <img src="{{result.picture.replace('.png','Red.png')}}" width="50" />
                    </td>
                    <td name="description_box">
                        <div data-ng-bind-html="displayHTML(result.block)"></div>
                        <br/>
                        <a href="single_display.php?id={{result.id}}&type=Advisor" ng-show="'{{key}}' == 'advisors'"
                        target="_blank">
	      See Details
	    </a>
                        <a href="single_display.php?id={{result.id}}&type=Course" ng-show="'{{key}}' == 'courses'"
                        target="_blank">
	      See Details
	    </a>
                        <a href="single_display.php?id={{result.id}}&type=Thesis" ng-show="'{{key}}' == 'theses'"
                        target="_blank">
	      See Details
	    </a>
                        <a href="single_display.php?id={{result.id}}&type={{result.type}}" ng-show="'{{key}}' == 'grants'"
                        target="_blank">
	      See Details
	    </a>
                        <a href="single_display.php?id={{result.id}}&type={{result.type}}" ng-show="'{{key}}' == 'extracurriculars'"
                        target="_blank">
	      See Details
	    </a>
                    </td>
                </tr>
            </table>
        </div>
    </td>
</tr>